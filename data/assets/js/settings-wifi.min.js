let wifiSsidField,wifiPwdField,wifiSaveBtn,btnAp;document.addEventListener("DOMContentLoaded",init);const savedToken=localStorage.getItem("token");async function init(){cacheElements(),bindEvents()}function cacheElements(){wifiSsidField=document.getElementById("pref-wifi-ssid"),wifiPwdField=document.getElementById("pref-wifi-pwd"),wifiSaveBtn=document.getElementById("btn-wifi"),btnAp=document.getElementById("btn-ap"),wifiSsidField.value="",wifiPwdField.value=""}function bindEvents(){wifiSaveBtn.addEventListener("click",handleSave),btnAp.addEventListener("click",handleAp)}async function handleSave(e){if(e.preventDefault(),wifiSsidField.value&&wifiPwdField.value)try{const e=new URLSearchParams({ssid:wifiSsidField.value,pwd:wifiPwdField.value});if(!(await fetch("/api/settings/wifi",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:savedToken},body:e})).ok)return void console.error("Save failed")}catch(e){console.error("Error saving WiFi settings:",e)}}async function handleAp(e){e.preventDefault();try{if(!(await fetch("/api/settings/ap",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:savedToken}})).ok)return void console.error("Save failed")}catch(e){console.error("Error activating Access Point mode:",e)}}