"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([["8504"],{8784:function(e,n,t){t.r(n),t.d(n,{frontMatter:()=>d,default:()=>u,toc:()=>h,metadata:()=>s,assets:()=>c,contentTitle:()=>l});var s=JSON.parse('{"id":"api/external-api","title":"External API","description":"The external API can be used to control the garage door by other systems or software.","source":"@site/docs/api/external-api.md","sourceDirName":"api","slug":"/api/external-api","permalink":"/PandaGarage/api/external-api","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1753719858000,"sidebarPosition":2,"frontMatter":{"title":"External API","sidebar_position":2},"sidebar":"docs","previous":{"title":"API","permalink":"/PandaGarage/api/introduction"},"next":{"title":"Debugging","permalink":"/PandaGarage/debugging"}}'),i=t(5893),r=t(65),o=t(7294);class a extends o.Component{render(){return(0,i.jsxs)("details",{className:"api-endpoint",children:[(0,i.jsxs)("summary",{className:"api-endpoint-header",children:[(0,i.jsx)("div",{className:`api-endpoint-method ${this.props.method}`,children:this.props.method}),(0,i.jsx)("code",{children:this.props.path}),(0,i.jsx)("div",{className:"api-endpoint-protection",title:this.props.unprotected?"Authentication is not required for this endpoint":"Authentication is required for this endpoint",children:this.props.unprotected?"\uD83D\uDD13":"\uD83D\uDD12"})]}),(0,i.jsx)("div",{className:"api-endpoint-content",children:this.props.children})]})}}let d={title:"External API",sidebar_position:2},l="External API Endpoints",c={},h=[{value:"Obtaining Auth Token",id:"obtaining-auth-token",level:3},{value:"Unprotected Endpoints",id:"unprotected-endpoints",level:3},{value:"Protected Endpoints",id:"protected-endpoints",level:3}];function p(e){let n={admonition:"admonition",code:"code",h1:"h1",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"external-api-endpoints",children:"External API Endpoints"})}),"\n",(0,i.jsx)(n.p,{children:"The external API can be used to control the garage door by other systems or software."}),"\n",(0,i.jsx)(n.admonition,{type:"tip",children:(0,i.jsx)(n.p,{children:"If authentication is enabled, you need to provide a Authorization header with a token.\nMore details are below."})}),"\n",(0,i.jsx)(n.p,{children:"Successful calls will return status code 200 or 201. Other status codes that can return are:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["400 - Bad Request","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"This indicates, that the requested endpoint is not found."}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["401 - Unauthorized","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["This indicates, that either the ",(0,i.jsx)(n.code,{children:"Authorization"})," header or the ",(0,i.jsx)(n.code,{children:"X-Access-Source"})," header is missing or wrong. Currently the ",(0,i.jsx)(n.code,{children:"X-Access-Source"})," is only required for the control endpoint."]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["403 - Forbidden","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"This indicates, that the requested endpoint is not reachable."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)("br",{}),"\n",(0,i.jsx)(n.h3,{id:"obtaining-auth-token",children:"Obtaining Auth Token"}),"\n",(0,i.jsxs)(a,{path:"/api/auth",method:"post",unprotected:"true",children:[(0,i.jsxs)(n.p,{children:["Send a POST request to the endpoint with ",(0,i.jsx)(n.code,{children:"Content-Type: application/x-www-form-urlencoded"})," and include ",(0,i.jsx)(n.code,{children:"pwd=<your password>"})," in the request body.\nThe response will return an authentication token \u2014 add it as the ",(0,i.jsx)(n.code,{children:"Authorization"})," header on all subsequent protected requests."]}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n    "token": "68asc...s18"\n}\n'})})]}),"\n",(0,i.jsx)(n.h3,{id:"unprotected-endpoints",children:"Unprotected Endpoints"}),"\n",(0,i.jsxs)(a,{path:"/api/info",method:"get",unprotected:"true",children:[(0,i.jsx)(n.p,{children:"Returns informations about the board if the API is up and running."}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n    "mac": "08:A6:F7:A8:6B:14",\n    "ip": "192.168.1.92",\n    "hostname": "PandaGarage-6B",\n    "rssi": -54,\n    "version_fw": "0.1.57",\n    "version_fs": "0.1.20",\n    "version_hw": "1.0",\n    "sn": "pg_52gjw_0000",\n    "uptime": 418069\n}\n'})})]}),"\n",(0,i.jsxs)(a,{path:"/api/status",method:"get",unprotected:"true",children:[(0,i.jsx)(n.p,{children:"Call this endpoint to get the current status of the garage door and it's sensors."}),(0,i.jsx)(n.p,{children:"Response will be:"}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n    "status": "ok",\n    "version_fw": "0.1.55",\n    "door": {\n        "position_current": 0,\n        "position_target": 0,\n        "state": "closed",\n        "moving": false,\n        "light": false\n    },\n    "sensor": {\n        "temperature": 33.35571,\n        "humidity": 35.55908,\n        "lux": 237,\n        "externalSensor": "none"\n    }\n}\n'})})]}),"\n",(0,i.jsxs)(a,{path:"/api/restart",method:"post",unprotected:"true",children:[(0,i.jsx)(n.p,{children:"Call this endpoint to restart your PandaGarage."}),(0,i.jsx)(n.p,{children:"Response will be:"}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n    "status": "restarting"\n}\n'})})]}),"\n",(0,i.jsx)("br",{}),"\n",(0,i.jsx)(n.h3,{id:"protected-endpoints",children:"Protected Endpoints"}),"\n",(0,i.jsxs)(a,{path:"/api/control",method:"post",children:[(0,i.jsx)(n.p,{children:"The control endpoint is used to control the actual garage door.\nIf the request was successful, the response will be a simple JSON message:"}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n    "status": "ok"\n}\n'})}),(0,i.jsxs)(n.p,{children:["You need to provide an ",(0,i.jsx)(n.code,{children:"action"})," parameter, containing one of the following values:"]}),(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"open"})," to open the garage door"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"close"})," to close the garage door"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"stop"})," to stop the garage door movement"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"vent"})," to move the garage door into vent position"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"half"})," to move the garage door into half position"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"position"})," move the garage door to a specific position.","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["An additional ",(0,i.jsx)(n.code,{children:"position"})," parameter is required. the value can be between ",(0,i.jsx)(n.code,{children:"0"})," and ",(0,i.jsx)(n.code,{children:"100"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"light"})," to control the built in light.","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["An additional optional ",(0,i.jsx)(n.code,{children:"state"})," parameter can be set with the values ",(0,i.jsx)(n.code,{children:"on"})," or ",(0,i.jsx)(n.code,{children:"off"}),"."]}),"\n",(0,i.jsx)(n.li,{children:"if no additional parameter is provided, the light will simply be toggled"}),"\n"]}),"\n"]}),"\n"]}),(0,i.jsxs)(n.p,{children:["Additionally to the Authorization header, the control endpoint requires a ",(0,i.jsx)(n.code,{children:"X-Access-Source"})," header. This header ",(0,i.jsx)(n.strong,{children:"must"})," be set to ",(0,i.jsx)(n.code,{children:"api"}),", otherwise you will receive a 401 error."]}),(0,i.jsx)("br",{}),(0,i.jsx)("br",{}),(0,i.jsx)(n.p,{children:"When the request has a wrong parameter or is missing a parameter the response will be:"}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n    "status": "invalid"\n}\n'})})]}),"\n",(0,i.jsxs)(a,{path:"/api/buzzer/play",method:"post",children:[(0,i.jsx)(n.p,{children:"Call this endpoint to play a provided tune from the buzzer."}),(0,i.jsxs)(n.p,{children:["You need to provde a ",(0,i.jsx)(n.code,{children:"tune"})," parameter, with the value of the tune you want to play. Currently 1-4."]}),(0,i.jsx)(n.p,{children:"Response will be:"}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n    "status": "ok"\n}\n'})})]})]})}function u(e={}){let{wrapper:n}={...(0,r.a)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(p,{...e})}):p(e)}},65:function(e,n,t){t.d(n,{Z:()=>a,a:()=>o});var s=t(7294);let i={},r=s.createContext(i);function o(e){let n=s.useContext(r);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);